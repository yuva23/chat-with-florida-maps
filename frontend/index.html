<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Chat with Florida Maps by Yuva</title>

  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  />

  <style>
    body { margin: 0; font-family: Arial, sans-serif; }
    #map { height: 100vh; width: 100vw; }
    .title {
      position: absolute;
      top: 10px;
      left: 50px;
      background: white;
      padding: 10px 14px;
      z-index: 1000;
      font-weight: bold;
      border-radius: 6px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
  </style>
</head>

<body>
  <div class="title">ðŸ§  Chat with Florida Maps by Yuva</div>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script>
    const map = L.map("map").setView([27.8, -81.7], 6);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "Â© OpenStreetMap contributors"
    }).addTo(map);

    async function loadIntentAndLayers() {
      const intent = await fetch("/backend/intent.json").then(r => r.json());

      const layerFiles = {
        rivers: "/data/rivers.geojson",
        counties: "/data/counties.geojson",
        waterbodies: "/data/waterbodies.geojson"
      };

      for (const layer of intent.layers) {
        if (!layerFiles[layer]) continue;

        const geojson = await fetch(layerFiles[layer]).then(r => r.json());

        L.geoJSON(geojson, {
          style: {
            color:
              layer === "rivers" ? "blue" :
              layer === "counties" ? "green" :
              "purple",
            weight: 2,
            fillOpacity: 0.3
          }
        }).addTo(map);
      }
    }

    loadIntentAndLayers();
  </script>
</body>
</html>
